{% extends 'master.html' %}

{% block css %}
    <link rel="stylesheet" href="/static/css/mycss/host_playbook_exe.css">
{% endblock %}

{% block content %}
    <div class="ibox float-e-margins">
    <div class="ibox-content">
        <div class="row row-lg">
            <div class="col-sm-6">
                <!-- Example Basic Sort -->
                <div class="host-wrap">
                    <div class="host-operation-heading">
                        <span class="host-title">主机列表</span>
                        <span>请选择需要执行剧本的主机</span>
                        <div class="btn-group">
                            <button data-toggle="dropdown" class="btn btn-primary dropdown-toggle">按组筛选 <span class="caret"></span>
                            </button>
                            <ul class="dropdown-menu">
                                <li><a href="/saltstack/playbook_exe/">全部</a></li>
                                {%for row in data.project_list%}
                                <li><a href="/saltstack/playbook_exe/{{row.name}}/">{{row.name}}</a></li>
                                {%endfor%}
                            </ul>
                        </div>
                        <button type="button" class="btn btn-warning choose">选择 >></button>
                    </div>
                    <div>
                        <table class="table table-striped table_host">
                            <thead>
                            <tr>
                                <th><input type="checkbox" id="chooseAll"></th>
                                <th>序号</th>
                                <th>主机ID</th>
                                <th>IP地址</th>
                                <th>所在地</th>
                                <th>状态</th>
                            </tr>
                            </thead>

                            <tbody id="chooseTbody">
                            {% for row in data.minion_list %}
                                <tr>
                                    <td><input type="checkbox"></td>
                                    <td>{{ forloop.counter }}</td>
                                    <td>{{ row.id }}</td>
                                    <td>{{ row.ipv4 }}</td>
                                    <td>{{ row.city }}</td>
                                    {% if row.status == 0 %}
                                    <td style="color: red">离线</td>
                                    {% elif row.status == 1 %}
                                    <td style="color: green">在线</td>
                                    {% elif row.status == 2 %}
                                    <td style="color: deepskyblue">检测中</td>
                                    {% else %}
                                    <td>异常</td>
                                    {% endif %}
                                </tr>

                            {% endfor %}
                            </tbody>

                        </table>
                    </div>
                </div>
                <!-- End Example Basic Sort -->
            </div>

            <div class="col-sm-6">
                <!-- Example Format Sort -->
                <div>
                    <div class="host-operation-heading">
                        <span>已选择的主机</span>
                        <button type="button" class="btn btn-warning remove"><< 移除</button>
                        <button type="button" class="btn btn-danger empty">清空所选</button>
                    </div>
                    <div>
                        <table class="table table-striped table_host">
                            <thead>
                            <tr>
                                <th><input type="checkbox"></th>
                                <th>序号</th>
                                <th>主机ID</th>
                                <th>IP地址</th>
                                <th>所在地</th>
                                <th>状态</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr>
                                <td>{{ forloop.counter }}</td>
                                <td>2</td>
                                <td>3</td>
                                <td>4</td>
                                <td>5</td>
                                <td>6</td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <!-- End Example Format Sort -->
            </div>

            <div class="clearfix hidden-xs"></div>

            <div class="col-sm-6">
                <!-- Example Custom Sort -->
                <div>
                    <div class="host-operation-heading">
                        <span>剧本列表</span>
                        <span>选择需要执行的剧本</span>
                        <button type="button" class="btn btn-success implement">开始执行</button>
                    </div>
                    <div>
                        <table class="table table-striped table_host">
                            <thead>
                            <tr>
                                <th><input type="checkbox"></th>
                                <th>序号</th>
                                <th>剧本</th>
                                <th>描述信息</th>
                                <th>所在组</th>
                            </tr>
                            </thead>
                            <tbody>
                            {% for row in data.playbook_list %}
                            <tr name="{{ row.sls }}">
                                <td><input type="checkbox"></td>
                                <td>{{ forloop.counter }}</td>
                                <td>{{ row.sls }}</td>
                                <td>{{ row.description }}</td>
                                <td>{{ row.project }}</td>
                            </tr>
                            {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
                <!-- End Example Custom Sort -->
            </div>

            <div class="col-sm-6">
                <!-- Example Hide Header -->
                <div>
                    <div class="host-operation-heading">
                        <span>剧本执行任务日志</span>
                    </div>
                    <div class="play-book-log">
                        <table class="table table-striped table_host">
                            <thead>
                            <tr>
                                <th>序号</th>
                                <th>任务 ID</th>
                                <th>任务描述</th>
                                <th>开始时间</th>
                                <th>结束时间</th>
                            </tr>
                            </thead>
                            <tbody>
                            {% for row in data.jobs_list %}
                            <tr>
                                <td>{{ forloop.revcounter }}</td>
                                <td>{{ row.jid }}</td>
                                <td>{{ row.description }}</td>
                                <td>{{ row.creationtime|date:"H:i:s" }}</td>
                                {% if row.completiontime == None %}
                                <td style="color: deepskyblue">执行中</td>
                                {% else %}
                                <td style="color: green">{{ row.completiontime|date:"H:i:s" }}</td>
                                {% endif %}
                            </tr>
                            {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
                <!-- End Example Hide Header -->
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block js %}
    <script src="/static/js/host_playbook_exe.js"></script>
{% endblock %}